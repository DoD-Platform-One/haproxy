hostname: {{ .Values.hostname }}
hosts:
- kiali
- tracing

podLabels:
  protect: keycloak
config: |
  global
    maxconn 1024
    daemon
    log stdout format raw local0 info
  defaults
    log global
    mode http
    option httplog
    timeout client 60s
    timeout connect 60s
    timeout server 60s
  frontend fe_main
    bind :8080
    acl host_kiali hdr(host) -i kiali.{{ .Values.hostname }}
    acl host_tracing hdr(host) -i tracing.{{ .Values.hostname }}
    option forwardfor
    use_backend kiali_main if host_kiali
    use_backend tracing_main if host_tracing
  backend kiali_main
    mode http
    server kiali kiali.istio-system.svc.cluster.local:20001
  backend tracing_main
    mode http
    server jaeger tracing.istio-system.svc.cluster.local:80
image:
  repository: registry1.dsop.io/ironbank/opensource/haproxy/haproxy22
containerPorts:
  http: 8080